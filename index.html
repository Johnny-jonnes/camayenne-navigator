<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="theme-color" content="#2563EB">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Camayenne">
  <meta name="description"
    content="Application de géolocalisation et navigation pour le quartier Camayenne, Dixinn, Conakry, Guinée">

  <!-- Favicon & Icons -->
  <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg?v=5">
  <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png?v=5">

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json?v=5">

  <!-- Preconnect pour performance -->
  <link rel="preconnect" href="https://unpkg.com">
  <link rel="preconnect" href="https://tile.openstreetmap.org">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">

  <!-- Fonts - Inter Variable -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Styles Application -->
  <link rel="stylesheet" href="assets/css/design-system.css?v=5">
  <link rel="stylesheet" href="assets/css/components.css?v=5">
  <link rel="stylesheet" href="assets/css/layouts.css?v=5">
  <link rel="stylesheet" href="assets/css/map-theme.css?v=5">
  <link rel="stylesheet" href="assets/css/navigation.css?v=5">
  <link rel="stylesheet" href="assets/css/animations.css?v=5">
  <link rel="stylesheet" href="assets/css/auth.css?v=5">

  <title>Camayenne Navigator</title>
</head>

<body>

  <!-- ============================================
       ÉCRAN DE CHARGEMENT INITIAL
       ============================================ -->
  <div id="splash-screen" class="splash-screen">
    <div class="splash-content">
      <div class="splash-logo">
        <div class="splash-logo-icon">
          <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="32" cy="32" r="28" fill="url(#logo-gradient)" />
            <path d="M32 16C24.268 16 18 22.268 18 30c0 10.5 14 22 14 22s14-11.5 14-22c0-7.732-6.268-14-14-14z"
              fill="white" />
            <circle cx="32" cy="30" r="6" fill="#2563EB" />
            <defs>
              <linearGradient id="logo-gradient" x1="4" y1="4" x2="60" y2="60" gradientUnits="userSpaceOnUse">
                <stop stop-color="#3B82F6" />
                <stop offset="1" stop-color="#1D4ED8" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <h1 class="splash-title">Camayenne</h1>
        <p class="splash-subtitle">Navigator</p>
      </div>
      <div class="splash-loader">
        <div class="splash-loader-bar"></div>
      </div>
      <p class="splash-status">Initialisation...</p>
    </div>
  </div>

  <!-- ============================================
       CONTENEUR PRINCIPAL APPLICATION
       ============================================ -->
  <div id="app" class="app-container" hidden>

    <!-- ─────────────────────────────────────────
         HEADER GLOBAL
         ───────────────────────────────────────── -->
    <header id="app-header" class="app-header">
      <div class="header-content">
        <!-- Section Compte Utilisateur -->
        <div id="user-account-section" class="user-account-section" style="margin-bottom: 20px;">
          <div id="user-logged-out" class="user-card-logged-out">
            <div class="user-welcome-text">
              <h3>Bienvenue à Camayenne</h3>
              <p>Connectez-vous pour plus de services</p>
            </div>
            <button id="btn-open-login" class="btn btn-primary btn-sm">
              Se connecter
            </button>
          </div>

          <div id="user-logged-in" class="user-card-logged-in" hidden>
            <div class="user-avatar">
              <span id="user-initials">U</span>
            </div>
            <div class="user-info">
              <h3 id="user-name">Utilisateur</h3>
              <span id="user-role" class="badge badge-outline">Membre</span>
            </div>
            <button id="btn-logout" class="btn btn-icon btn-text">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
            </button>
          </div>
        </div>

        <!-- Météo Widget -->
        <div class="header-brand">
          <div class="header-logo">
            <svg width="32" height="32" viewBox="0 0 64 64" fill="none">
              <circle cx="32" cy="32" r="28" fill="url(#header-logo-grad)" />
              <path d="M32 16C24.268 16 18 22.268 18 30c0 10.5 14 22 14 22s14-11.5 14-22c0-7.732-6.268-14-14-14z"
                fill="white" />
              <circle cx="32" cy="30" r="6" fill="#2563EB" />
              <defs>
                <linearGradient id="header-logo-grad" x1="4" y1="4" x2="60" y2="60" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#3B82F6" />
                  <stop offset="1" stop-color="#1D4ED8" />
                </linearGradient>
              </defs>
            </svg>
          </div>
          <div class="header-title">
            <span class="header-name">Camayenne</span>
            <span class="header-zone">Dixinn, Conakry</span>
          </div>
        </div>
        <div class="header-actions">
          <button id="btn-offline-indicator" class="header-status" title="Statut connexion">
            <span class="status-dot online"></span>
            <span class="status-text">En ligne</span>
          </button>
        </div>
      </div>
    </header>

    <!-- ─────────────────────────────────────────
         CONTENEUR PAGES (VUES)
         ───────────────────────────────────────── -->
    <main id="main-content" class="main-content">

      <!-- ═══════════════════════════════════════
           PAGE : ACCUEIL (Position)
           ═══════════════════════════════════════ -->
      <section id="page-home" class="page page-home active" data-page="home">
        <div class="page-scroll">

          <!-- Hero Position -->
          <div class="section-position">
            <div id="position-hero" class="position-hero">
              <div class="position-hero-badge">
                <span class="position-hero-badge-dot"></span>
                <span>Position actuelle</span>
              </div>
              <p id="position-hero-label" class="position-hero-label">Tu es à</p>
              <h2 id="position-address" class="position-hero-address">
                Localisation en cours...
              </h2>
              <div class="position-hero-actions">
                <button id="btn-share-position" class="btn btn-secondary">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8" />
                    <polyline points="16 6 12 2 8 6" />
                    <line x1="12" y1="2" x2="12" y2="15" />
                  </svg>
                  <span>Partager</span>
                </button>
                <button id="btn-view-on-map" class="btn btn-accent">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6" />
                    <line x1="8" y1="2" x2="8" y2="18" />
                    <line x1="16" y1="6" x2="16" y2="22" />
                  </svg>
                  <span>Voir sur la carte</span>
                </button>
              </div>
            </div>

            <!-- Bouton actualiser position -->
            <button id="btn-refresh-position" class="btn-refresh-position">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 11-9-9" />
                <polyline points="21 3 21 9 15 9" />
              </svg>
              <span>Actualiser ma position</span>
            </button>
          </div>

          <!-- Erreur hors zone -->
          <div id="out-of-zone-warning" class="out-of-zone-warning" hidden>
            <div class="warning-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
              </svg>
            </div>
            <h3 class="warning-title">Vous êtes hors de Camayenne</h3>
            <p class="warning-message">
              Cette application est conçue exclusivement pour le quartier Camayenne à Dixinn.
              Certaines fonctionnalités peuvent être limitées.
            </p>
          </div>

          <!-- Section Alertes -->
          <div class="section-alerts">
            <div class="section-header">
              <h3 class="section-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="section-icon">
                  <path
                    d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" />
                </svg>
                Alertes locales
              </h3>
              <span id="alerts-count" class="badge">0</span>
            </div>
            <div id="alerts-container" class="alerts-list">
              <div class="empty-state">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path
                    d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" />
                </svg>
                <p>Aucune alerte en cours</p>
              </div>
            </div>
          </div>

          <!-- Accès rapide catégories -->
          <div class="section-quick-access">
            <div class="section-header">
              <h3 class="section-title">Accès rapide</h3>
            </div>
            <div class="quick-access-grid">
              <button class="quick-access-item" data-category="health">
                <div class="quick-access-icon health">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" />
                  </svg>
                </div>
                <span class="quick-access-label">Santé</span>
              </button>
              <button class="quick-access-item" data-category="security">
                <div class="quick-access-icon security">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z" />
                  </svg>
                </div>
                <span class="quick-access-label">Sécurité</span>
              </button>
              <button class="quick-access-item" data-category="admin">
                <div class="quick-access-icon admin">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z" />
                  </svg>
                </div>
                <span class="quick-access-label">Administration</span>
              </button>
              <button class="quick-access-item" data-category="transport">
                <div class="quick-access-icon transport">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z" />
                  </svg>
                </div>
                <span class="quick-access-label">Transport</span>
              </button>
              <button class="quick-access-item" data-category="leisure">
                <div class="quick-access-icon leisure">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M8 14s1.5 2 4 2 4-2 4-2" stroke="white" stroke-width="1.5" fill="none" />
                    <circle cx="9" cy="9" r="1.5" fill="white" />
                    <circle cx="15" cy="9" r="1.5" fill="white" />
                  </svg>
                </div>
                <span class="quick-access-label">Loisirs</span>
              </button>
            </div>
          </div>

        </div>
      </section>

      <!-- ═══════════════════════════════════════
           PAGE : CARTE
           ═══════════════════════════════════════ -->
      <section id="page-map" class="page page-map" data-page="map">
        <!-- Conteneur carte Leaflet -->
        <div id="map-container" class="map-container"></div>

        <!-- Contrôles carte -->
        <div class="map-controls">
          <button id="btn-center-user" class="btn btn-icon btn-secondary map-control-btn"
            title="Centrer sur ma position">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3" />
              <path d="M12 2v4m0 12v4M2 12h4m12 0h4" />
            </svg>
          </button>
          <button id="btn-zoom-in" class="btn btn-icon btn-secondary map-control-btn" title="Zoom +">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
          </button>
          <button id="btn-zoom-out" class="btn btn-icon btn-secondary map-control-btn" title="Zoom -">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
          </button>
        </div>

        <!-- Légende carte -->
        <div id="map-legend" class="map-legend">
          <button class="map-legend-toggle" aria-expanded="false">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z" />
            </svg>
            <span>Légende</span>
          </button>
          <div class="map-legend-content">
            <div class="legend-item">
              <span class="legend-marker legend-marker-user"></span>
              <span>Votre position</span>
            </div>
            <div class="legend-item">
              <span class="legend-marker legend-marker-health"></span>
              <span>Santé</span>
            </div>
            <div class="legend-item">
              <span class="legend-marker legend-marker-security"></span>
              <span>Sécurité</span>
            </div>
            <div class="legend-item">
              <span class="legend-marker legend-marker-admin"></span>
              <span>Administration</span>
            </div>
            <div class="legend-item">
              <span class="legend-marker legend-marker-transport"></span>
              <span>Transport</span>
            </div>
            <div class="legend-item">
              <span class="legend-marker legend-marker-leisure"></span>
              <span>Loisirs</span>
            </div>
          </div>
        </div>

        <!-- Panneau navigation (affiché lors du "S'y rendre") -->
        <div id="navigation-panel" class="navigation-panel"></div>
      </section>

      <!-- ═══════════════════════════════════════
           PAGE : LIEUX ESSENTIELS
           ═══════════════════════════════════════ -->
      <section id="page-places" class="page page-places" data-page="places">
        <div class="page-scroll">

          <!-- Barre de recherche -->
          <div class="search-bar-container">
            <div class="search-bar">
              <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <circle cx="11" cy="11" r="8" />
                <path d="M21 21l-4.35-4.35" />
              </svg>
              <input type="search" id="search-input" class="search-input" placeholder="Rechercher un lieu..."
                autocomplete="off">
              <button id="btn-clear-search" class="search-clear" hidden>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                </svg>
              </button>
            </div>
          </div>

          <!-- Filtres catégories -->
          <div class="category-filters">
            <button class="category-filter active" data-filter="all">
              <span>Tous</span>
            </button>
            <button class="category-filter" data-filter="health">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" />
              </svg>
              <span>Santé</span>
            </button>
            <button class="category-filter" data-filter="security">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
              </svg>
              <span>Sécurité</span>
            </button>
            <button class="category-filter" data-filter="admin">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10z" />
              </svg>
              <span>Admin</span>
            </button>
            <button class="category-filter" data-filter="transport">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99z" />
              </svg>
              <span>Transport</span>
            </button>
            <button class="category-filter" data-filter="leisure">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <circle cx="12" cy="12" r="10" />
              </svg>
              <span>Loisirs</span>
            </button>
          </div>

          <!-- Liste des lieux -->
          <div id="places-list" class="places-list">
            <!-- Rempli dynamiquement -->
          </div>

        </div>
      </section>

      <!-- ═══════════════════════════════════════
           PAGE : ALERTES
           ═══════════════════════════════════════ -->
      <section id="page-alerts" class="page page-alerts" data-page="alerts">
        <div class="page-scroll">

          <div class="page-header">
            <h2 class="page-title">Alertes locales</h2>
            <p class="page-subtitle">Informations importantes à Camayenne</p>
          </div>

          <div id="alerts-full-list" class="alerts-full-list">
            <!-- Rempli dynamiquement -->
          </div>

        </div>
      </section>

    </main>

    <!-- ─────────────────────────────────────────
         BARRE DE NAVIGATION INFÉRIEURE
         ───────────────────────────────────────── -->
    <nav id="bottom-nav" class="bottom-nav">
      <a href="#home" class="nav-item active" data-nav="home">
        <span class="nav-item-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
          </svg>
        </span>
        <span class="nav-item-label">Position</span>
      </a>
      <a href="#map" class="nav-item" data-nav="map">
        <span class="nav-item-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z" />
          </svg>
        </span>
        <span class="nav-item-label">Carte</span>
      </a>
      <a href="#places" class="nav-item" data-nav="places">
        <span class="nav-item-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
          </svg>
        </span>
        <span class="nav-item-label">Lieux</span>
      </a>
      <a href="#alerts" class="nav-item" data-nav="alerts">
        <span class="nav-item-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" />
          </svg>
        </span>
        <span class="nav-item-label">Alertes</span>
        <span id="nav-alerts-badge" class="nav-badge" hidden>0</span>
      </a>
    </nav>

  </div>

  <!-- ============================================
       BOTTOM SHEET — DÉTAIL LIEU
       ============================================ -->
  <div id="place-detail-overlay" class="bottom-sheet-overlay"></div>
  <div id="place-detail-sheet" class="bottom-sheet">
    <div class="bottom-sheet-handle"></div>
    <div class="bottom-sheet-header">
      <h3 id="place-detail-title" class="bottom-sheet-title">Nom du lieu</h3>
      <button id="btn-close-place-detail" class="btn btn-icon btn-secondary">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div id="place-detail-body" class="bottom-sheet-body">
      <!-- Contenu dynamique -->
    </div>
  </div>

  <!-- ============================================
       CONTENEUR TOASTS
       ============================================ -->
  <div id="toast-container" class="toast-container"></div>

  <!-- AUTH MODAL -->
  <div id="auth-modal-overlay" class="auth-modal-overlay">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
          </svg>
        </div>
        <div class="auth-title">Connexion</div>
        <div class="auth-subtitle">Accédez à votre espace Camayenne</div>
      </div>
      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">Connexion</button>
        <button class="auth-tab" data-tab="register">Créer un compte</button>
      </div>

      <div id="auth-error" class="auth-error-message">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <span id="auth-error-text">Erreur de connexion</span>
      </div>

      <!-- FORMULAIRE CONNEXION -->
      <form id="auth-form-login" class="auth-form active">
        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="email" id="login-email" class="auth-input" placeholder="Adresse email" required
              autocomplete="email">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
            </div>
          </div>
        </div>

        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="password" id="login-password" class="auth-input" placeholder="Mot de passe" required
              autocomplete="current-password">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            </div>
          </div>
        </div>

        <div class="auth-form-actions">
          <a href="#" id="link-forgot-password" class="auth-link-sm">Mot de passe oublié ?</a>
        </div>

        <button type="submit" class="btn-auth-submit">Se connecter</button>
      </form>

      <!-- FORMULAIRE INSCRIPTION -->
      <form id="auth-form-register" class="auth-form">
        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="text" id="register-name" class="auth-input" placeholder="Nom complet" required
              autocomplete="name">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </div>
          </div>
        </div>

        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="email" id="register-email" class="auth-input" placeholder="Adresse email" required
              autocomplete="email">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
            </div>
          </div>
        </div>

        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="password" id="register-password" class="auth-input"
              placeholder="Mot de passe (6 caractères min)" required autocomplete="new-password" minlength="6">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            </div>
          </div>
        </div>

        <!-- Confirm Password -->
        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="password" id="register-confirm-password" class="auth-input"
              placeholder="Confirmer le mot de passe" required autocomplete="new-password" minlength="6">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
              </svg>
            </div>
          </div>
        </div>

        <button type="submit" class="btn-auth-submit">Créer un compte</button>
      </form>

      <!-- FORMULAIRE RESET HEADER (Caché par défaut) -->
      <form id="auth-form-reset" class="auth-form">
        <div class="auth-header-reset">
          <button type="button" id="btn-back-to-login" class="btn-back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            Retour
          </button>
          <h4>Réinitialisation</h4>
        </div>
        <p class="auth-text-sm">Entrez votre email pour recevoir un lien de réinitialisation.</p>

        <div class="auth-form-group">
          <div class="auth-input-wrapper">
            <input type="email" id="reset-email" class="auth-input" placeholder="Adresse email" required
              autocomplete="email">
            <div class="auth-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
            </div>
          </div>
        </div>

        <button type="submit" class="btn-auth-submit">Envoyer</button>
      </form>


    </div>
  </div>

  <!-- ============================================
       MODAL PARTAGE
       ============================================ -->
  <div id="share-modal-overlay" class="modal-overlay"></div>
  <div id="share-modal" class="modal">
    <div class="modal-header">
      <h3 class="modal-title">Partager ma position</h3>
      <button id="btn-close-share-modal" class="btn btn-icon btn-secondary">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <p id="share-address-text" class="share-address-text"></p>
      <div class="share-actions">
        <button id="btn-copy-address" class="btn btn-primary btn-full">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" />
          </svg>
          <span>Copier l'adresse</span>
        </button>
        <button id="btn-whatsapp-share" class="btn btn-whatsapp btn-full"
          style="margin-top: 10px; background-color: #25D366; color: white;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12.031 6.172c-2.277 0-4.119 1.841-4.119 4.118 0 .727.19 1.439.549 2.064l-.582 2.126 2.176-.571a4.093 4.093 0 001.976.501h.001c2.277 0 4.12-1.841 4.12-4.118 0-1.103-.43-2.14-1.209-2.919a4.084 4.084 0 00-2.912-1.201zM14.471 12.3c-.131-.065-.771-.381-.889-.425-.119-.045-.205-.065-.29.065-.084.13-.328.424-.403.51-.073.085-.147.095-.278.03-.131-.065-.552-.204-1.052-.65-.389-.346-.65-.772-.726-.902-.075-.13-.008-.2.057-.264.059-.059.13-.153.197-.23.065-.078.085-.132.129-.22.043-.09.022-.165-.011-.231-.033-.065-.29-.699-.398-.958-.106-.255-.213-.22-.29-.224l-.248-.003c-.084 0-.223.033-.339.16-.117.13-.448.438-.448 1.066 0 .628.456 1.235.52 1.32.065.09.898 1.371 2.175 1.923.303.131.54.21.725.267.306.096.584.084.805.05.244-.037.771-.315.88-.619.108-.303.108-.564.075-.618-.032-.054-.117-.087-.248-.152z" />
          </svg>
          <span>Partager via WhatsApp</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================
       SCRIPTS
       ============================================ -->
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <!-- Scripts -->
  <script src="assets/js/core/utils.js?v=5"></script>
  <script src="assets/js/core/state.js?v=5"></script>
  <script src="assets/js/modules/geolocation.js?v=5"></script>
  <script src="assets/js/modules/address.js?v=5"></script>
  <script src="assets/js/modules/map.js?v=5"></script>
  <script src="assets/js/modules/routing.js?v=5"></script>
  <script src="assets/js/modules/places.js?v=5"></script>
  <script src="assets/js/modules/alerts.js?v=5"></script>
  <script src="assets/js/modules/offline.js?v=5"></script>
  <script src="assets/js/components/toast.js?v=5"></script>
  <script src="assets/js/components/bottom-sheet.js?v=5"></script>
  <script src="assets/js/core/auth.js?v=5"></script>
  <script src="assets/js/core/app.js?v=5"></script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('[SW] Registered:', registration.scope);
          })
          .catch(error => {
            console.log('[SW] Registration failed:', error);
          });
      });
    }
  </script>

</body>

</html>